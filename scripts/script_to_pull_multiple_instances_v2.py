import json
import requests
from pprint import pprint
import pandas as pd

#playerIDs Top 80 
player_id = [83003505,118692797,86782037,297766761,29110522,168669208,483004518,905095056,115919999,89026526,112041009,895964558,91907884,162180111,1055044510,113446485,111348444,323619849,77053789,95930249,437231529,123756190,140571204,144498359,301269486,173118561,287994064,92080451,140011059,215463143,136782462,134199428,194798847,260184615,179763529,200864218,214464143,314024034,333065824,438173115,342388807,115269893,993497808,177924776,847108724,154444477,373523739,890770204,132534565,182519925,480723099,246787221,218808498,274938592,1032720323,183238586,257319387,331776191,136385031,242985726,349914678,193206507,427606549,242246429,224708958,458624011,362993030,911505806,318286721,101072333,147411378,922664462,411632574,196842947,27178898,193495945,100670945,199138576,173596982,903056691,65131717,376466482,422982641,286580656,189260204,132294685,447835809,145297034,129530532,150537827,112740723,142270375,946000136,96928450,1051246927,268590680,86860683,180076810,163913761,348367120,83003505]
 
'''for element in player_id: 
    url_name= "https://api.opendota.com/api/players/" + str(element) 
    print(url_name)
    r = requests.get(url_name)
    answer =r.text
    json_data = json.loads(answer)
    json_data = pd.json_normalize(json_data)
    df = pd.DataFrame(json_data)
    df = df.to_csv(str('player'+str(element)+'.csv'))
'''

# API CALL 
# https://api.opendota.com/api/players/{account_id}/recentMatches

for element in player_id: 
    url_name= "https://api.opendota.com/api/players/" + str(element) +"/recentMatches?api_key=352f2bed-ecf4-4c21-a0fa-959ce2df18d3"
    print(url_name)
    player_request = requests.get(url_name)
    player = player_request.text
    top_player_json_data = json.loads(player)
    top_player_json_data = pd.json_normalize(top_player_json_data)
    df = pd.DataFrame(top_player_json_data)
    df = df.to_csv(str(element))
